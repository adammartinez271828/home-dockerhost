version: '3.7'
services:

  nginx-proxy-manager:
    container_name: con_nginx-proxy-manager
    image: jc21/nginx-proxy-manager:latest
    restart: unless-stopped
    ports:
      - '80:80'
      - '81:81'
      - '443:443'
    volumes:
      - ./data:/data
      - ./letsencrypt:/etc/letsencrypt
    healthcheck:
      test: ["CMD", "/bin/check-health"]
      interval: 10s
      timeout: 3s

  pihole2:
    container_name: con_pihole2
    image: pihole/pihole:latest
    restart: unless-stopped
    # For DHCP it is recommended to remove these ports and instead add: network_mode: "host"
    ports:
      - '53:53/tcp'
      - '53:53/udp'
      # - '67:67/udp' # Only required if you are using Pi-hole as your DHCP server
      # - '80:80/tcp'
    environment:
      DNSMASQ_LISTENING: 'all'
      PIHOLE_DNS_: 1.1.1.1;1.0.0.1
      TZ: 'America/New_York'
      WEBPASSWORD: '${PW_PIHOLE}'
      WEBTHEME: 'default-dark'
    # Volumes store your data between container upgrades
    volumes:
      - './etc-pihole:/etc/pihole'
      - './etc-dnsmasq.d:/etc/dnsmasq.d'
    # https://github.com/pi-hole/docker-pi-hole#note-on-capabilities
    cap_add:
      - NET_ADMIN  # Required if you are using Pi-hole as your DHCP server, else not needed

  dashy:
    container_name: con_dashy
    image: lissy93/dashy
    restart: unless-stopped
    # Pass in your config file below, by specifying the path on your host machine
    # volumes:
      # - /root/my-config.yml:/app/public/conf.yml
    # ports:
      # - 4000:80
    # Set any environmental variables
    environment:
      - NODE_ENV=production
    # Specify your user ID and group ID. You can find this by running `id -u` and `id -g`
      # - UID=1000
      # - GID=1000
    # Configure healthchecks
    healthcheck:
      test: ['CMD', 'node', '/app/services/healthcheck']
      interval: 1m30s
      timeout: 10s
      retries: 3
      start_period: 40s

networks:
  default:
    name: network_landockernet
    external: true
